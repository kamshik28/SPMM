<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Конференція</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<div class="conference-container">
    <div class="video-container" id="user1">
        <video id="localVideo" autoplay muted></video>
        <div class="controls">
            <button id="toggleCamera">Ввімкнути/Вимкнути камеру</button>
            <button id="toggleMic">Ввімкнути/Вимкнути мікрофон</button>
        </div>
    </div>
    <div class="video-container" id="user2">
        <video id="remoteVideo1" autoplay></video>
        <p>Користувач 2</p>
    </div>
    <div class="video-container" id="user3">
        <video id="remoteVideo2" autoplay></video>
        <p>Користувач 3</p>
    </div>
</div>

<div class="action-buttons">
    <button id="joinCall">+</button>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>
    let localStream = null;
    let micEnabled = false;
    let videoEnabled = false;

    // Отримання локального відео та аудіо
    const joinCall = () => {
        navigator.mediaDevices.getUserMedia({ video: true, audio: true })
            .then(stream => {
                localStream = stream;
                const localVideo = document.getElementById('localVideo');
                localVideo.srcObject = stream;

                localStream.getVideoTracks()[0].enabled = videoEnabled;
                localStream.getAudioTracks()[0].enabled = micEnabled;
            })
            .catch(error => {
                console.error('Помилка при доступі до відео/аудіо', error);
            });
    };

    // Функція для ввімкнення/вимкнення камери
    const toggleCamera = () => {
        if (localStream) {
            videoEnabled = !videoEnabled;
            localStream.getVideoTracks()[0].enabled = videoEnabled;
            console.log(`Камера ${videoEnabled ? "ввімкнена" : "вимкнена"}`);
        }
    };

    // Функція для ввімкнення/вимкнення мікрофона
    const toggleMic = () => {
        if (localStream) {
            micEnabled = !micEnabled;
            localStream.getAudioTracks()[0].enabled = micEnabled;
            console.log(`Мікрофон ${micEnabled ? "ввімкнений" : "вимкнений"}`);
        }
    };

    document.getElementById('joinCall').addEventListener('click', joinCall);
    document.getElementById('toggleCamera').addEventListener('click', toggleCamera);
    document.getElementById('toggleMic').addEventListener('click', toggleMic);
</script>
</body>
</html>
